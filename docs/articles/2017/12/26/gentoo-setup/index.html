
<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">

  <title>Gentooの初期設定</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="author" content="Hidetatsu Yaginuma">

  <link href="/markdown.css" rel="stylesheet"></link>
</head>


<body>
<h2><a href="/">dtyler.io</a></h2>

<h1><a href="/article/2017/12/26/gentoo-setup/">Gentooの初期設定</a></h1>

<p>2017/12/26</p>

<p>Gentooの初期設定をメモる。</p>

<p>ネットワーク周りについては、色々ハマったので<a href="https://yagi5.com/2017/12/26/gentoo-setup-network/">こちら</a>に書いた。</p>

<h3>ユーザ作成</h3>

<pre><code>% useradd -m -G users,wheel,audio -s /bin/bash ユーザー名
% passwd ユーザー名
</code></pre>

<h3>sudo導入</h3>

<p>sudoがないとなにもできない。</p>

<pre><code>% emerge sudo

### 設定
% visudo

### ここのコメントアウトを外す
%wheel   ALL=(ALL)   NOPASSWD: ALL
</code></pre>

<p>これにより、wheelグループに入っているユーザはsudoできるようになる。</p>

<h3>sshdを導入</h3>

<p>sshdを入れて、Macからsshで入って作業できるようにする。(色々と便利なので。)
sshd自体はデフォルトで入っていた。</p>

<pre><code>### 起動時にsshdをあげる
% rc-update add sshd default
% rc-service sshd start

### 作っておく
% mkdir ~/.ssh
</code></pre>

<p>まずはMac側で作業。</p>

<pre><code>$ cd ~/.ssh
$ ssh-keygen -t rsa -f gentoo_rsa
$ scp ./gentoo_rsa.pub ユーザー名@gentooホストのIP:~/.ssh
</code></pre>

<p>Gentoo側で作業</p>

<pre><code>$ cd ~
$ chmod 700 .ssh
$ cd .ssh
$ cat gentoo_rsa.pub &gt;&gt; authorized_keys
$ chmod 600 authorized_keys
$ rm -fv gentoo_rsa.pub
</code></pre>

<pre><code>$ sudo vi /etc/ssh/sshd_config
</code></pre>

<p>以下のようにする。</p>

<pre><code>PubkeyAuthentication yes
AuthorizedKeysFile     .ssh/authorized_keys
PermitRootLogin no
PasswordAuthentication no
</code></pre>

<p>sshd再起動</p>

<pre><code>$ rc-service sshd restart
</code></pre>

<p>Mac側でエイリアスを設定する。</p>

<pre><code>$ vi ~/.ssh/config
</code></pre>

<pre><code>Host gentoo
  User ユーザ名
  HostName IP
  IdentityFile ~/.ssh/gentoo_rsa
</code></pre>

<p>これで、Macから <code>ssh gentoo</code> で入れるようになる。</p>

<h3>NTP導入</h3>

<p>ntpdをあげておく。</p>

<pre><code>$ rc-service ntpd start
$ rc-update add ntpd default
</code></pre>

<h3>zsh導入</h3>

<p>zshにしておく。</p>

<pre><code>$ emerge --ask app-shells/zsh
$ emerge --ask app-shells/zsh-completions
</code></pre>

<p>初期設定</p>

<pre><code>### .zshrcはお好みで。
$ touch ~/.zshrc
$ chsh -s /bin/zsh
</code></pre>

<h3>git導入</h3>

<pre><code>emerge --ask dev-vcs/git
</code></pre>

</body>

</html>
